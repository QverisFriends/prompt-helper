# Prompt-Helper 需求文档

## 1. 应用概述

### 1.1 应用名称
Prompt-Helper

### 1.2 应用描述
一个支持单聊和多Agent群聊的对话Agent系统。用户可以在后台面板手动设置系统提示词，并支持多角色切换、对话记录管理、历史对话查看等功能。在群聊模式下，支持多Agent并发回答和决断官统筹功能。\n
## 2. 核心功能

### 2.1 提示词管理
- 用户可在后台面板手动设置系统提示词
- 支持多角色提示词设置
- 支持提示词分类管理
- 支持提示词版本保存
- 支持提示词导出导入

### 2.2 多角色切换
- 支持创建多个角色
- 支持快速切换不同角色
- 每个角色可独立配置提示词

### 2.3 对话记录管理
- 自动保存历史对话记录
- 支持查看历史对话内容
- 支持对话记录搜索
- 支持删除或清空对话记录

### 2.4 历史对话查看
- 按时间顺序展示历史对话
- 支持按角色筛选对话记录
- 支持对话内容导出

### 2.5 多Agent群聊功能
- 支持用户组建包含多个Agent的群聊
- 用户可从角色库中选择2个或以上的Agent加入群聊
- 支持指定某个Agent为决断官，或使用系统默认的AI助理作为决断官
- 群聊应保留历史上下文

### 2.6 并发咨询逻辑
- 用户在群聊模式下发送问题
- 群内的普通Agent根据各自人设独立回答
- 各Agent的回答无需等待全部完成即可依次展示

### 2.7 决断官统筹逻辑
- 当所有普通Agent回答完毕后，决断官自动触发
- 决断官阅读用户问题及所有Agent的回答
- 决断官输出最终的统筹建议

## 3. 用户权限

### 3.1 权限设置
- 系统不区分管理员和普通用户
- 所有用户拥有相同权限
- 所有功能对所有用户开放

## 4. 界面交互

### 4.1 群组管理界面
- 提供群组创建功能
- 支持群名设置
- 提供多选列表让用户选择参与的Agent
- 支持指定决断官

### 4.2 聊天窗口布局
- 采用流式卡片布局
- 用户发出消息后显示“正在咨询各位专家...”\n- Agent回复气泡采用不同颜色的边框或头像区分
- 决断官时刻展示在所有Agent气泡下方，使用特殊分割线或高亮框标识
- 决断官标题为“最终决断”或“统筹建议”\n
## 5. 技术实现关键点

### 5.1 数据结构调整
- 新增 GroupSession 概念
- 包含 group_id、name、members、judge_id、history 等字段

### 5.2 提示词工程
- 普通Agent复用原有Prompt
- 决断官预设 Meta-Prompt：\n  - System Prompt (决断官模版)：\n    - 你是一个会议主持人及决策者
    - 任务是阅读用户的问题以及团队成员的回答
    - 总结各方观点（指明是谁提出的）\n    - 识别各方观点的冲突点和共同点
    - 基于你的专业身份，给出一个综合性的最终建议
    - 请直接对用户说话，不要提及‘根据上下文’等技术词汇

### 5.3 并发性能
- 使用异步并发同时请求 LLM API 获取各Agent的回复
- 绝不能串行执行
- 超时处理：某个Agent 15秒不出结果时，决断官跳过该Agent直接进行总结